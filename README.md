# Strmly Backend API

Strmly is a comprehensive video streaming platform backend built with Node.js, Express.js, and MongoDB. This API provides endpoints for user authentication, video management, series creation, community features, and more.

## Features

- User Authentication & Authorization (JWT-based)
- Video Upload & Management (Long videos and Shorts)
- Series Management with Episodes
- Community Features (Create, Follow, Manage)
- User Interactions (Like, Share, Comment)
- Search Functionality (Global & Personalized)
- AWS S3 Integration for File Storage
- User Profile Management
- Content Moderation & Safety Features

## Tech Stack

- **Runtime**: Node.js
- **Framework**: Express.js
- **Database**: MongoDB with Mongoose ODM
- **Authentication**: JSON Web Tokens (JWT)
- **File Storage**: AWS S3
- **Password Hashing**: bcrypt
- **File Upload**: Multer
- **Environment Management**: dotenv

## Prerequisites

- Node.js (v14 or higher)
- MongoDB database
- AWS S3 bucket for file storage
- npm or yarn package manager

## Environment Variables

Create a `.env` file in the root directory with the following variables:

```env
PORT=5000
MONGODB_URI=mongodb://localhost:27017/strmly
JWT_SECRET=your_jwt_secret_key
AWS_ACCESS_KEY_ID=your_aws_access_key
AWS_SECRET_ACCESS_KEY=your_aws_secret_key
AWS_REGION=your_aws_region
AWS_S3_BUCKET=your_s3_bucket_name
```

## Installation

1. Clone the repository
2. Install dependencies:
   ```bash
   npm install
   ```
3. Set up environment variables
4. Start the development server:
   ```bash
   npm run dev
   ```
5. For production:
   ```bash
   npm start
   ```

## Project Structure

```
backend/
├── config/          # Configuration files
├── controller/      # Route controllers
├── middleware/      # Custom middleware
├── models/          # MongoDB models
├── routes/          # API routes
├── utils/           # Utility functions
└── server.js        # Main application file
```

## API Endpoints

### Authentication Routes (`/api/v1/auth`)

| Route             | Method | Request Body                    | Status Code | Response Schema                                                                                                                                                                              | Description                   |
| ----------------- | ------ | ------------------------------- | ----------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------- |
| `/register`       | POST   | `{ username, email, password }` | 201         | `{ message: "User registered successfully", token: "jwt_token", user: { _id: "user_id", username: "string", email: "string", profilePicture: "string", createdAt: "date", bio: "string" } }` | Register a new user           |
|                   |        |                                 | 400         | `{ message: "Username/Email already exists" }`                                                                                                                                               |                               |
|                   |        |                                 | 500         | `{ message: "Server error" }`                                                                                                                                                                |                               |
| `/login/email`    | POST   | `{ email, password }`           | 200         | `{ message: "Login successful", token: "jwt_token", user: { _id: "user_id", username: "string", email: "string", profilePicture: "string", bio: "string" } }`                                | Login with email              |
|                   |        |                                 | 400         | `{ message: "Invalid credentials" }`                                                                                                                                                         |                               |
|                   |        |                                 | 500         | `{ message: "Server error" }`                                                                                                                                                                |                               |
| `/login/username` | POST   | `{ username, password }`        | 200         | `{ message: "Login successful", token: "jwt_token", user: { _id: "user_id", username: "string", email: "string", profilePicture: "string", bio: "string" } }`                                | Login with username           |
|                   |        |                                 | 400         | `{ message: "Invalid credentials" }`                                                                                                                                                         |                               |
|                   |        |                                 | 500         | `{ message: "Server error" }`                                                                                                                                                                |                               |
| `/logout`         | POST   | -                               | 200         | `{ message: "Logout successful" }`                                                                                                                                                           | Logout user                   |
|                   |        |                                 | 500         | `{ message: "Server error" }`                                                                                                                                                                |                               |
| `/refresh`        | POST   | -                               | 200         | `{ message: "Token refreshed", token: "jwt_token", user: { _id: "user_id", username: "string", email: "string", profilePicture: "string", bio: "string" } }`                                 | Refresh JWT token (Protected) |
|                   |        |                                 | 401         | `{ message: "Unauthorized" }`                                                                                                                                                                |                               |
|                   |        |                                 | 500         | `{ message: "Server error" }`                                                                                                                                                                |                               |

### Video Routes (`/api/v1/videos`)

| Route              | Method | Request Body                       | Status Code | Response Schema                                                                                                                                                                                                                                                                                                                                   | Description                      |
| ------------------ | ------ | ---------------------------------- | ----------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------- |
| `/upload`          | POST   | FormData with video file           | 201         | `{ message: "Video uploaded successfully", video: { _id: "video_id", title: "string", description: "string", videoUrl: "string", thumbnailUrl: "string", duration: "number", views: 0, likes: 0, shares: 0, uploader: "user_id", genre: "string", tags: ["string"], createdAt: "date" } }`                                                        | Upload a new video (Protected)   |
|                    |        |                                    | 400         | `{ message: "Invalid file format or missing file" }`                                                                                                                                                                                                                                                                                              |                                  |
|                    |        |                                    | 401         | `{ message: "Unauthorized" }`                                                                                                                                                                                                                                                                                                                     |                                  |
|                    |        |                                    | 500         | `{ message: "Server error" }`                                                                                                                                                                                                                                                                                                                     |                                  |
| `/search`          | GET    | Query params: `q`, `page`, `limit` | 200         | `{ videos: [{ _id: "video_id", title: "string", thumbnailUrl: "string", duration: "number", views: "number", uploader: { _id: "user_id", username: "string" }, createdAt: "date" }], pagination: { currentPage: "number", totalPages: "number", totalVideos: "number" } }`                                                                        | Search videos                    |
|                    |        |                                    | 400         | `{ message: "Invalid search query" }`                                                                                                                                                                                                                                                                                                             |                                  |
|                    |        |                                    | 500         | `{ message: "Server error" }`                                                                                                                                                                                                                                                                                                                     |                                  |
| `/trending`        | GET    | Query params: `page`, `limit`      | 200         | `{ videos: [{ _id: "video_id", title: "string", thumbnailUrl: "string", duration: "number", views: "number", uploader: { _id: "user_id", username: "string" }, createdAt: "date" }], pagination: { currentPage: "number", totalPages: "number", totalVideos: "number" } }`                                                                        | Get trending videos              |
|                    |        |                                    | 500         | `{ message: "Server error" }`                                                                                                                                                                                                                                                                                                                     |                                  |
| `/by-genre/:genre` | GET    | Query params: `page`, `limit`      | 200         | `{ videos: [{ _id: "video_id", title: "string", thumbnailUrl: "string", duration: "number", views: "number", uploader: { _id: "user_id", username: "string" }, createdAt: "date" }], pagination: { currentPage: "number", totalPages: "number", totalVideos: "number" } }`                                                                        | Get videos by genre              |
|                    |        |                                    | 400         | `{ message: "Invalid genre" }`                                                                                                                                                                                                                                                                                                                    |                                  |
|                    |        |                                    | 500         | `{ message: "Server error" }`                                                                                                                                                                                                                                                                                                                     |                                  |
| `/:id`             | GET    | -                                  | 200         | `{ video: { _id: "video_id", title: "string", description: "string", videoUrl: "string", thumbnailUrl: "string", duration: "number", views: "number", likes: "number", shares: "number", uploader: { _id: "user_id", username: "string", profilePicture: "string" }, genre: "string", tags: ["string"], createdAt: "date", updatedAt: "date" } }` | Get video by ID                  |
|                    |        |                                    | 404         | `{ message: "Video not found" }`                                                                                                                                                                                                                                                                                                                  |                                  |
|                    |        |                                    | 500         | `{ message: "Server error" }`                                                                                                                                                                                                                                                                                                                     |                                  |
| `/:id`             | PUT    | `{ title, description, tags }`     | 200         | `{ message: "Video updated successfully", video: { _id: "video_id", title: "string", description: "string", tags: ["string"], updatedAt: "date" } }`                                                                                                                                                                                              | Update video (Protected)         |
|                    |        |                                    | 400         | `{ message: "Invalid input data" }`                                                                                                                                                                                                                                                                                                               |                                  |
|                    |        |                                    | 401         | `{ message: "Unauthorized" }`                                                                                                                                                                                                                                                                                                                     |                                  |
|                    |        |                                    | 403         | `{ message: "Not authorized to update this video" }`                                                                                                                                                                                                                                                                                              |                                  |
|                    |        |                                    | 404         | `{ message: "Video not found" }`                                                                                                                                                                                                                                                                                                                  |                                  |
|                    |        |                                    | 500         | `{ message: "Server error" }`                                                                                                                                                                                                                                                                                                                     |                                  |
| `/:id`             | DELETE | -                                  | 200         | `{ message: "Video deleted successfully" }`                                                                                                                                                                                                                                                                                                       | Delete video (Protected)         |
|                    |        |                                    | 401         | `{ message: "Unauthorized" }`                                                                                                                                                                                                                                                                                                                     |                                  |
|                    |        |                                    | 403         | `{ message: "Not authorized to delete this video" }`                                                                                                                                                                                                                                                                                              |                                  |
|                    |        |                                    | 404         | `{ message: "Video not found" }`                                                                                                                                                                                                                                                                                                                  |                                  |
|                    |        |                                    | 500         | `{ message: "Server error" }`                                                                                                                                                                                                                                                                                                                     |                                  |
| `/:id/view`        | POST   | -                                  | 200         | `{ message: "View count incremented", views: "number" }`                                                                                                                                                                                                                                                                                          | Increment view count (Protected) |
|                    |        |                                    | 401         | `{ message: "Unauthorized" }`                                                                                                                                                                                                                                                                                                                     |                                  |
|                    |        |                                    | 404         | `{ message: "Video not found" }`                                                                                                                                                                                                                                                                                                                  |                                  |
|                    |        |                                    | 500         | `{ message: "Server error" }`                                                                                                                                                                                                                                                                                                                     |                                  |
| `/:id/related`     | GET    | -                                  | 200         | `{ videos: [{ _id: "video_id", title: "string", thumbnailUrl: "string", duration: "number", views: "number", uploader: { _id: "user_id", username: "string" }, createdAt: "date" }] }`                                                                                                                                                            | Get related videos               |
|                    |        |                                    | 404         | `{ message: "Video not found" }`                                                                                                                                                                                                                                                                                                                  |                                  |
|                    |        |                                    | 500         | `{ message: "Server error" }`                                                                                                                                                                                                                                                                                                                     |                                  |

### Series Routes (`/api/v1/series`)

| Route                            | Method | Request Body                       | Status Code | Response Schema                                                                                                                                                                                                                                                                                                                                                                    | Description                            |
| -------------------------------- | ------ | ---------------------------------- | ----------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------- |
| `/create`                        | POST   | `{ title, description, genre }`    | 201         | `{ message: "Series created successfully", series: { _id: "series_id", title: "string", description: "string", genre: "string", creator: "user_id", episodes: [], createdAt: "date", updatedAt: "date" } }`                                                                                                                                                                        | Create new series (Protected)          |
|                                  |        |                                    | 400         | `{ message: "Invalid input data" }`                                                                                                                                                                                                                                                                                                                                                |                                        |
|                                  |        |                                    | 401         | `{ message: "Unauthorized" }`                                                                                                                                                                                                                                                                                                                                                      |                                        |
|                                  |        |                                    | 500         | `{ message: "Server error" }`                                                                                                                                                                                                                                                                                                                                                      |                                        |
| `/search`                        | GET    | Query params: `q`, `page`, `limit` | 200         | `{ series: [{ _id: "series_id", title: "string", description: "string", genre: "string", creator: { _id: "user_id", username: "string" }, episodeCount: "number", createdAt: "date" }], pagination: { currentPage: "number", totalPages: "number", totalSeries: "number" } }`                                                                                                      | Search series                          |
|                                  |        |                                    | 400         | `{ message: "Invalid search query" }`                                                                                                                                                                                                                                                                                                                                              |                                        |
|                                  |        |                                    | 500         | `{ message: "Server error" }`                                                                                                                                                                                                                                                                                                                                                      |                                        |
| `/all`                           | GET    | Query params: `page`, `limit`      | 200         | `{ series: [{ _id: "series_id", title: "string", description: "string", genre: "string", creator: { _id: "user_id", username: "string" }, episodeCount: "number", createdAt: "date" }], pagination: { currentPage: "number", totalPages: "number", totalSeries: "number" } }`                                                                                                      | Get all series                         |
|                                  |        |                                    | 500         | `{ message: "Server error" }`                                                                                                                                                                                                                                                                                                                                                      |                                        |
| `/:id`                           | GET    | -                                  | 200         | `{ series: { _id: "series_id", title: "string", description: "string", genre: "string", creator: { _id: "user_id", username: "string", profilePicture: "string" }, episodes: [{ _id: "episode_id", video: { _id: "video_id", title: "string", thumbnailUrl: "string", duration: "number" }, episodeNumber: "number", addedAt: "date" }], createdAt: "date", updatedAt: "date" } }` | Get series by ID                       |
|                                  |        |                                    | 404         | `{ message: "Series not found" }`                                                                                                                                                                                                                                                                                                                                                  |                                        |
|                                  |        |                                    | 500         | `{ message: "Server error" }`                                                                                                                                                                                                                                                                                                                                                      |                                        |
| `/:id`                           | PUT    | `{ title, description }`           | 200         | `{ message: "Series updated successfully", series: { _id: "series_id", title: "string", description: "string", updatedAt: "date" } }`                                                                                                                                                                                                                                              | Update series (Protected)              |
|                                  |        |                                    | 400         | `{ message: "Invalid input data" }`                                                                                                                                                                                                                                                                                                                                                |                                        |
|                                  |        |                                    | 401         | `{ message: "Unauthorized" }`                                                                                                                                                                                                                                                                                                                                                      |                                        |
|                                  |        |                                    | 403         | `{ message: "Not authorized to update this series" }`                                                                                                                                                                                                                                                                                                                              |                                        |
|                                  |        |                                    | 404         | `{ message: "Series not found" }`                                                                                                                                                                                                                                                                                                                                                  |                                        |
|                                  |        |                                    | 500         | `{ message: "Server error" }`                                                                                                                                                                                                                                                                                                                                                      |                                        |
| `/:id`                           | DELETE | -                                  | 200         | `{ message: "Series deleted successfully" }`                                                                                                                                                                                                                                                                                                                                       | Delete series (Protected)              |
|                                  |        |                                    | 401         | `{ message: "Unauthorized" }`                                                                                                                                                                                                                                                                                                                                                      |                                        |
|                                  |        |                                    | 403         | `{ message: "Not authorized to delete this series" }`                                                                                                                                                                                                                                                                                                                              |                                        |
|                                  |        |                                    | 404         | `{ message: "Series not found" }`                                                                                                                                                                                                                                                                                                                                                  |                                        |
|                                  |        |                                    | 500         | `{ message: "Server error" }`                                                                                                                                                                                                                                                                                                                                                      |                                        |
| `/:id/episodes`                  | POST   | `{ videoId, episodeNumber }`       | 200         | `{ message: "Episode added to series", series: { _id: "series_id", title: "string", episodes: [{ _id: "episode_id", video: "video_id", episodeNumber: "number", addedAt: "date" }] } }`                                                                                                                                                                                            | Add episode to series (Protected)      |
|                                  |        |                                    | 400         | `{ message: "Invalid input data or episode already exists" }`                                                                                                                                                                                                                                                                                                                      |                                        |
|                                  |        |                                    | 401         | `{ message: "Unauthorized" }`                                                                                                                                                                                                                                                                                                                                                      |                                        |
|                                  |        |                                    | 403         | `{ message: "Not authorized to modify this series" }`                                                                                                                                                                                                                                                                                                                              |                                        |
|                                  |        |                                    | 404         | `{ message: "Series or video not found" }`                                                                                                                                                                                                                                                                                                                                         |                                        |
|                                  |        |                                    | 500         | `{ message: "Server error" }`                                                                                                                                                                                                                                                                                                                                                      |                                        |
| `/:seriesId/episodes/:episodeId` | DELETE | -                                  | 200         | `{ message: "Episode removed from series" }`                                                                                                                                                                                                                                                                                                                                       | Remove episode from series (Protected) |
|                                  |        |                                    | 401         | `{ message: "Unauthorized" }`                                                                                                                                                                                                                                                                                                                                                      |                                        |
|                                  |        |                                    | 403         | `{ message: "Not authorized to modify this series" }`                                                                                                                                                                                                                                                                                                                              |                                        |
|                                  |        |                                    | 404         | `{ message: "Series or episode not found" }`                                                                                                                                                                                                                                                                                                                                       |                                        |
|                                  |        |                                    | 500         | `{ message: "Server error" }`                                                                                                                                                                                                                                                                                                                                                      |                                        |

### Shorts Routes (`/api/v1/shorts`)

| Route       | Method | Request Body                  | Status Code | Response Schema                                                                                                                                                                                                                                                                                                                           | Description                    |
| ----------- | ------ | ----------------------------- | ----------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------ |
| `/feed`     | GET    | Query params: `page`, `limit` | 200         | `{ shorts: [{ _id: "short_id", title: "string", videoUrl: "string", thumbnailUrl: "string", duration: "number", views: "number", likes: "number", uploader: { _id: "user_id", username: "string", profilePicture: "string" }, createdAt: "date" }], pagination: { currentPage: "number", totalPages: "number", totalShorts: "number" } }` | Get shorts feed                |
|             |        |                               | 500         | `{ message: "Server error" }`                                                                                                                                                                                                                                                                                                             |                                |
| `/trending` | GET    | Query params: `page`, `limit` | 200         | `{ shorts: [{ _id: "short_id", title: "string", videoUrl: "string", thumbnailUrl: "string", duration: "number", views: "number", likes: "number", uploader: { _id: "user_id", username: "string", profilePicture: "string" }, createdAt: "date" }], pagination: { currentPage: "number", totalPages: "number", totalShorts: "number" } }` | Get trending shorts            |
|             |        |                               | 500         | `{ message: "Server error" }`                                                                                                                                                                                                                                                                                                             |                                |
| `/:id`      | GET    | -                             | 200         | `{ short: { _id: "short_id", title: "string", description: "string", videoUrl: "string", thumbnailUrl: "string", duration: "number", views: "number", likes: "number", shares: "number", uploader: { _id: "user_id", username: "string", profilePicture: "string" }, tags: ["string"], createdAt: "date", updatedAt: "date" } }`          | Get short video by ID          |
|             |        |                               | 404         | `{ message: "Short video not found" }`                                                                                                                                                                                                                                                                                                    |                                |
|             |        |                               | 500         | `{ message: "Server error" }`                                                                                                                                                                                                                                                                                                             |                                |
| `/:id`      | PUT    | `{ title, description }`      | 200         | `{ message: "Short video updated successfully", short: { _id: "short_id", title: "string", description: "string", updatedAt: "date" } }`                                                                                                                                                                                                  | Update short video (Protected) |
|             |        |                               | 400         | `{ message: "Invalid input data" }`                                                                                                                                                                                                                                                                                                       |                                |
|             |        |                               | 401         | `{ message: "Unauthorized" }`                                                                                                                                                                                                                                                                                                             |                                |
|             |        |                               | 403         | `{ message: "Not authorized to update this short video" }`                                                                                                                                                                                                                                                                                |                                |
|             |        |                               | 404         | `{ message: "Short video not found" }`                                                                                                                                                                                                                                                                                                    |                                |
|             |        |                               | 500         | `{ message: "Server error" }`                                                                                                                                                                                                                                                                                                             |                                |
| `/:id`      | DELETE | -                             | 200         | `{ message: "Short video deleted successfully" }`                                                                                                                                                                                                                                                                                         | Delete short video (Protected) |
|             |        |                               | 401         | `{ message: "Unauthorized" }`                                                                                                                                                                                                                                                                                                             |                                |
|             |        |                               | 403         | `{ message: "Not authorized to delete this short video" }`                                                                                                                                                                                                                                                                                |                                |
|             |        |                               | 404         | `{ message: "Short video not found" }`                                                                                                                                                                                                                                                                                                    |                                |
|             |        |                               | 500         | `{ message: "Server error" }`                                                                                                                                                                                                                                                                                                             |                                |

### User Routes (`/api/v1/user`)

| Route            | Method | Request Body                  | Status Code | Response Schema                                                                                                                                                                                                                                                                                      | Description                       |
| ---------------- | ------ | ----------------------------- | ----------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------- |
| `/feed`          | GET    | Query params: `page`, `limit` | 200         | `{ feed: [{ _id: "content_id", type: "video/short", title: "string", thumbnailUrl: "string", uploader: { _id: "user_id", username: "string", profilePicture: "string" }, views: "number", createdAt: "date" }], pagination: { currentPage: "number", totalPages: "number", totalItems: "number" } }` | Get user feed (Protected)         |
|                  |        |                               | 401         | `{ message: "Unauthorized" }`                                                                                                                                                                                                                                                                        |                                   |
|                  |        |                               | 500         | `{ message: "Server error" }`                                                                                                                                                                                                                                                                        |                                   |
| `/profile`       | GET    | -                             | 200         | `{ user: { _id: "user_id", username: "string", email: "string", bio: "string", profilePicture: "string", followers: "number", following: "number", videosCount: "number", createdAt: "date", interests: ["string"] } }`                                                                              | Get user profile (Protected)      |
|                  |        |                               | 401         | `{ message: "Unauthorized" }`                                                                                                                                                                                                                                                                        |                                   |
|                  |        |                               | 500         | `{ message: "Server error" }`                                                                                                                                                                                                                                                                        |                                   |
| `/profile`       | PUT    | `{ username, email, bio }`    | 200         | `{ message: "Profile updated successfully", user: { _id: "user_id", username: "string", email: "string", bio: "string", profilePicture: "string", updatedAt: "date" } }`                                                                                                                             | Update profile (Protected)        |
|                  |        |                               | 400         | `{ message: "Invalid input data or username/email already exists" }`                                                                                                                                                                                                                                 |                                   |
|                  |        |                               | 401         | `{ message: "Unauthorized" }`                                                                                                                                                                                                                                                                        |                                   |
|                  |        |                               | 500         | `{ message: "Server error" }`                                                                                                                                                                                                                                                                        |                                   |
| `/communities`   | GET    | -                             | 200         | `{ communities: [{ _id: "community_id", name: "string", description: "string", profilePicture: "string", membersCount: "number", joinedAt: "date" }] }`                                                                                                                                              | Get user communities (Protected)  |
|                  |        |                               | 401         | `{ message: "Unauthorized" }`                                                                                                                                                                                                                                                                        |                                   |
|                  |        |                               | 500         | `{ message: "Server error" }`                                                                                                                                                                                                                                                                        |                                   |
| `/videos`        | GET    | -                             | 200         | `{ videos: [{ _id: "video_id", title: "string", thumbnailUrl: "string", duration: "number", views: "number", likes: "number", type: "long/short", createdAt: "date" }] }`                                                                                                                            | Get user videos (Protected)       |
|                  |        |                               | 401         | `{ message: "Unauthorized" }`                                                                                                                                                                                                                                                                        |                                   |
|                  |        |                               | 500         | `{ message: "Server error" }`                                                                                                                                                                                                                                                                        |                                   |
| `/interactions`  | GET    | -                             | 200         | `{ interactions: { likes: [{ _id: "video_id", title: "string", likedAt: "date" }], shares: [{ _id: "video_id", title: "string", sharedAt: "date" }], comments: [{ _id: "comment_id", content: "string", video: { _id: "video_id", title: "string" }, createdAt: "date" }] } }`                       | Get user interactions (Protected) |
|                  |        |                               | 401         | `{ message: "Unauthorized" }`                                                                                                                                                                                                                                                                        |                                   |
|                  |        |                               | 500         | `{ message: "Server error" }`                                                                                                                                                                                                                                                                        |                                   |
| `/earnings`      | GET    | -                             | 200         | `{ earnings: { totalEarnings: "number", thisMonth: "number", thisWeek: "number", recentTransactions: [{ _id: "transaction_id", type: "earning/withdrawal", amount: "number", description: "string", date: "date" }] } }`                                                                             | Get user earnings (Protected)     |
|                  |        |                               | 401         | `{ message: "Unauthorized" }`                                                                                                                                                                                                                                                                        |                                   |
|                  |        |                               | 500         | `{ message: "Server error" }`                                                                                                                                                                                                                                                                        |                                   |
| `/notifications` | GET    | -                             | 200         | `{ notifications: [{ _id: "notification_id", type: "like/comment/follow", message: "string", isRead: "boolean", from: { _id: "user_id", username: "string", profilePicture: "string" }, createdAt: "date" }] }`                                                                                      | Get notifications (Protected)     |
|                  |        |                               | 401         | `{ message: "Unauthorized" }`                                                                                                                                                                                                                                                                        |                                   |
|                  |        |                               | 500         | `{ message: "Server error" }`                                                                                                                                                                                                                                                                        |                                   |
| `/interests`     | PUT    | `{ interests }`               | 200         | `{ message: "Interests updated successfully", user: { _id: "user_id", interests: ["string"], updatedAt: "date" } }`                                                                                                                                                                                  | Update user interests             |
|                  |        |                               | 400         | `{ message: "Invalid interests data" }`                                                                                                                                                                                                                                                              |                                   |
|                  |        |                               | 401         | `{ message: "Unauthorized" }`                                                                                                                                                                                                                                                                        |                                   |
|                  |        |                               | 500         | `{ message: "Server error" }`                                                                                                                                                                                                                                                                        |                                   |

### Community Routes (`/api/v1/community`)

| Route                   | Method | Request Body                | Status Code | Response Schema                                                                                                                                                                                                   | Description                      |
| ----------------------- | ------ | --------------------------- | ----------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------- |
| `/create`               | POST   | `{ name, description }`     | 201         | `{ message: "Community created successfully", community: { _id: "community_id", name: "string", description: "string", creator: "user_id", members: ["user_id"], profilePicture: "string", createdAt: "date" } }` | Create community (Protected)     |
|                         |        |                             | 400         | `{ message: "Invalid input data or community name already exists" }`                                                                                                                                              |                                  |
|                         |        |                             | 401         | `{ message: "Unauthorized" }`                                                                                                                                                                                     |                                  |
|                         |        |                             | 500         | `{ message: "Server error" }`                                                                                                                                                                                     |                                  |
| `/rename`               | PUT    | `{ communityId, newName }`  | 200         | `{ message: "Community renamed successfully", community: { _id: "community_id", name: "string", updatedAt: "date" } }`                                                                                            | Rename community (Protected)     |
|                         |        |                             | 400         | `{ message: "Invalid input data or name already exists" }`                                                                                                                                                        |                                  |
|                         |        |                             | 401         | `{ message: "Unauthorized" }`                                                                                                                                                                                     |                                  |
|                         |        |                             | 403         | `{ message: "Not authorized to rename this community" }`                                                                                                                                                          |                                  |
|                         |        |                             | 404         | `{ message: "Community not found" }`                                                                                                                                                                              |                                  |
|                         |        |                             | 500         | `{ message: "Server error" }`                                                                                                                                                                                     |                                  |
| `/change-profile-photo` | PUT    | `{ communityId, photoUrl }` | 200         | `{ message: "Profile photo updated successfully", community: { _id: "community_id", profilePicture: "string", updatedAt: "date" } }`                                                                              | Change profile photo (Protected) |
|                         |        |                             | 400         | `{ message: "Invalid input data or photo URL" }`                                                                                                                                                                  |                                  |
|                         |        |                             | 401         | `{ message: "Unauthorized" }`                                                                                                                                                                                     |                                  |
|                         |        |                             | 403         | `{ message: "Not authorized to modify this community" }`                                                                                                                                                          |                                  |
|                         |        |                             | 404         | `{ message: "Community not found" }`                                                                                                                                                                              |                                  |
|                         |        |                             | 500         | `{ message: "Server error" }`                                                                                                                                                                                     |                                  |
| `/follow`               | POST   | `{ communityId }`           | 200         | `{ message: "Successfully followed/unfollowed community", isFollowing: "boolean" }`                                                                                                                               | Follow community (Protected)     |
|                         |        |                             | 400         | `{ message: "Invalid community ID" }`                                                                                                                                                                             |                                  |
|                         |        |                             | 401         | `{ message: "Unauthorized" }`                                                                                                                                                                                     |                                  |
|                         |        |                             | 404         | `{ message: "Community not found" }`                                                                                                                                                                              |                                  |
|                         |        |                             | 500         | `{ message: "Server error" }`                                                                                                                                                                                     |                                  |
| `/add-bio`              | PUT    | `{ communityId, bio }`      | 200         | `{ message: "Bio updated successfully", community: { _id: "community_id", bio: "string", updatedAt: "date" } }`                                                                                                   | Add bio to community (Protected) |
|                         |        |                             | 400         | `{ message: "Invalid input data" }`                                                                                                                                                                               |                                  |
|                         |        |                             | 401         | `{ message: "Unauthorized" }`                                                                                                                                                                                     |                                  |
|                         |        |                             | 403         | `{ message: "Not authorized to modify this community" }`                                                                                                                                                          |                                  |
|                         |        |                             | 404         | `{ message: "Community not found" }`                                                                                                                                                                              |                                  |
|                         |        |                             | 500         | `{ message: "Server error" }`                                                                                                                                                                                     |                                  |

### Interaction Routes (`/api/v1/interaction`

| Route          | Method | Request Body                               | Status Code | Response Schema                                                                                                                                                                                                | Description                   |
| -------------- | ------ | ------------------------------------------ | ----------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------- |
| `/like`        | POST   | `{ videoId, type }`                        | 200         | `{ message: "Video liked/unliked successfully", liked: "boolean", totalLikes: "number" }`                                                                                                                      | Like/unlike video (Protected) |
|                |        |                                            | 400         | `{ message: "Invalid video ID or type" }`                                                                                                                                                                      |                               |
|                |        |                                            | 401         | `{ message: "Unauthorized" }`                                                                                                                                                                                  |                               |
|                |        |                                            | 404         | `{ message: "Video not found" }`                                                                                                                                                                               |                               |
|                |        |                                            | 500         | `{ message: "Server error" }`                                                                                                                                                                                  |                               |
| `/share`       | POST   | `{ videoId, platform }`                    | 200         | `{ message: "Video shared successfully", shareUrl: "string", totalShares: "number" }`                                                                                                                          | Share video (Protected)       |
|                |        |                                            | 400         | `{ message: "Invalid video ID or platform" }`                                                                                                                                                                  |                               |
|                |        |                                            | 401         | `{ message: "Unauthorized" }`                                                                                                                                                                                  |                               |
|                |        |                                            | 404         | `{ message: "Video not found" }`                                                                                                                                                                               |                               |
|                |        |                                            | 500         | `{ message: "Server error" }`                                                                                                                                                                                  |                               |
| `/comment`     | POST   | `{ videoId, content }`                     | 201         | `{ message: "Comment added successfully", comment: { _id: "comment_id", content: "string", author: { _id: "user_id", username: "string", profilePicture: "string" }, video: "video_id", createdAt: "date" } }` | Comment on video (Protected)  |
|                |        |                                            | 400         | `{ message: "Invalid video ID or empty content" }`                                                                                                                                                             |                               |
|                |        |                                            | 401         | `{ message: "Unauthorized" }`                                                                                                                                                                                  |                               |
|                |        |                                            | 404         | `{ message: "Video not found" }`                                                                                                                                                                               |                               |
|                |        |                                            | 500         | `{ message: "Server error" }`                                                                                                                                                                                  |                               |
| `/gift-comment` | POST   | `{ videoId, videoType, commentId, amount, giftNote }` | 200         | `{ message: "Gift sent successfully", gift: { amount: "number", from: "string", to: "string", videoTitle: "string", commentPreview: "string", giftNote: "string", transferType: "string" }, gifter: { balanceBefore: "number", balanceAfter: "number", currentBalance: "number" }, receiver: { balanceBefore: "number", balanceAfter: "number", currentBalance: "number", receivedAmount: "number" } }` | Gift comment (Protected)      |
|                |        |                                            | 400         | `{ message: "Invalid input data or insufficient balance" }`                                                                                                                                                     |                               |
|                |        |                                            | 401         | `{ message: "Unauthorized" }`                                                                                                                                                                                  |                               |
|                |        |                                            | 404         | `{ message: "Video or comment not found" }`                                                                                                                                                                    |                               |
|                |        |                                            | 500         | `{ message: "Server error" }`                                                                                                                                                                                  |                               |
| `/history`              | GET    | Query params: `page`, `limit`          | 200         | `{ withdrawals: [{ _id: "withdrawal_id", amount: "number", status: "pending/completed/failed", bankAccount: { accountNumber: "string", ifsc: "string", accountName: "string" }, requestedAt: "date", processedAt: "date", failureReason: "string" }], pagination: { currentPage: "number", totalPages: "number", totalWithdrawals: "number" } }` | Get withdrawal history (Protected)    |
|                         |        |                                        | 401         | `{ message: "Unauthorized" }`                                                                                                                                                                                                                                                                                                                    |                                       |
|                         |        |                                        | 500         | `{ message: "Server error" }`                                                                                                                                                                                                                                                                                                                    |                                       |
| `/status/:withdrawalId` | GET    | -                                      | 200         | `{ withdrawal: { _id: "withdrawal_id", userId: "user_id", amount: "number", status: "pending/completed/failed", bankAccount: { accountNumber: "string", ifsc: "string", accountName: "string" }, requestedAt: "date", processedAt: "date", failureReason: "string", trackingId: "string" } }`                                                    | Check withdrawal status (Protected)   |
|                         |        |                                        | 401         | `{ message: "Unauthorized" }`                                                                                                                                                                                                                                                                                                                    |                                       |
|                         |        |                                        | 404         | `{ message: "Withdrawal not found" }`                                                                                                                                                                                                                                                                                                            |                                       |
|                         |        |                                        | 500         | `{ message: "Server error" }`                                                                                                                                                                                                                                                                                                                    |                                       |

### Webhook Routes (`/api/v1/webhooks`)

| Route       | Method | Request Body          | Status Code | Response Schema                                                                         | Description              |
| ----------- | ------ | --------------------- | ----------- | --------------------------------------------------------------------------------------- | ------------------------ |
| `/razorpay` | POST   | Razorpay webhook data | 200         | `{ received: "true", processed: "boolean", message: "Webhook processed successfully" }` | Handle Razorpay webhooks |
|             |        |                       | 400         | `{ message: "Invalid webhook data" }`                                                   |                          |
|             |        |                       | 401         | `{ message: "Unauthorized webhook" }`                                                   |                          |
|             |        |                       | 500         | `{ message: "Server error" }`                                                           |                          |

### Caution Routes (`/api/v1/caution`)

| Route                     | Method | Request Body               | Status Code | Response Schema                                                                             | Description                             |
| ------------------------- | ------ | -------------------------- | ----------- | ------------------------------------------------------------------------------------------- | --------------------------------------- |
| `/video/long/:videoId`    | DELETE | -                          | 200         | `{ message: "Long video deleted successfully" }`                                            | Delete long video (Protected)           |
|                           |        |                            | 401         | `{ message: "Unauthorized" }`                                                               |                                         |
|                           |        |                            | 403         | `{ message: "Not authorized to delete this video" }`                                        |                                         |
|                           |        |                            | 404         | `{ message: "Video not found" }`                                                            |                                         |
|                           |        |                            | 500         | `{ message: "Server error" }`                                                               |                                         |
| `/video/short/:videoId`   | DELETE | -                          | 200         | `{ message: "Short video deleted successfully" }`                                           | Delete short video (Protected)          |
|                           |        |                            | 401         | `{ message: "Unauthorized" }`                                                               |                                         |
|                           |        |                            | 403         | `{ message: "Not authorized to delete this video" }`                                        |                                         |
|                           |        |                            | 404         | `{ message: "Video not found" }`                                                            |                                         |
|                           |        |                            | 500         | `{ message: "Server error" }`                                                               |                                         |
| `/videos/bulk`            | DELETE | `{ videoIds }`             | 200         | `{ message: "Videos deleted successfully", deletedCount: "number", failedCount: "number" }` | Bulk delete videos (Protected)          |
|                           |        |                            | 400         | `{ message: "Invalid video IDs or empty array" }`                                           |                                         |
|                           |        |                            | 401         | `{ message: "Unauthorized" }`                                                               |                                         |
|                           |        |                            | 500         | `{ message: "Server error" }`                                                               |                                         |
| `/profile`                | DELETE | -                          | 200         | `{ message: "User profile deleted successfully" }`                                          | Delete user profile (Protected)         |
|                           |        |                            | 401         | `{ message: "Unauthorized" }`                                                               |                                         |
|                           |        |                            | 500         | `{ message: "Server error" }`                                                               |                                         |
| `/community/:communityId` | DELETE | -                          | 200         | `{ message: "Community deleted successfully" }`                                             | Delete community (Protected)            |
|                           |        |                            | 401         | `{ message: "Unauthorized" }`                                                               |                                         |
|                           |        |                            | 403         | `{ message: "Not authorized to delete this community" }`                                    |                                         |
|                           |        |                            | 404         | `{ message: "Community not found" }`                                                        |                                         |
|                           |        |                            | 500         | `{ message: "Server error" }`                                                               |                                         |
| `/series/:seriesId`       | DELETE | -                          | 200         | `{ message: "Series deleted successfully" }`                                                | Delete series (Protected)               |
|                           |        |                            | 401         | `{ message: "Unauthorized" }`                                                               |                                         |
|                           |        |                            | 403         | `{ message: "Not authorized to delete this series" }`                                       |                                         |
|                           |        |                            | 404         | `{ message: "Series not found" }`                                                           |                                         |
|                           |        |                            | 500         | `{ message: "Server error" }`                                                               |                                         |
| `/community/remove-video` | PATCH  | `{ communityId, videoId }` | 200         | `{ message: "Video removed from community successfully" }`                                  | Remove video from community (Protected) |
|                           |        |                            | 400         | `{ message: "Invalid community or video ID" }`                                              |                                         |
|                           |        |                            | 401         | `{ message: "Unauthorized" }`                                                               |                                         |
|                           |        |                            | 403         | `{ message: "Not authorized to modify this community" }`                                    |                                         |
|                           |        |                            | 404         | `{ message: "Community or video not found" }`                                               |                                         |
|                           |        |                            | 500         | `{ message: "Server error" }`                                                               |                                         |
| `/community/unfollow`     | PATCH  | `{ communityId }`          | 200         | `{ message: "Successfully unfollowed community" }`                                          | Unfollow community (Protected)          |
|                           |        |                            | 400         | `{ message: "Invalid community ID" }`                                                       |                                         |
|                           |        |                            | 401         | `{ message: "Unauthorized" }`                                                               |                                         |
|                           |        |                            | 404         | `{ message: "Community not found or not following" }`                                       |                                         |
|                           |        |                            | 500         | `{ message: "Server error" }`                                                               |                                         |
| `/community/remove-user`  | PATCH  | `{ communityId, userId }`  | 200         | `{ message: "User removed from community successfully" }`                                   | Remove user from community (Protected)  |
|                           |        |                            | 400         | `{ message: "Invalid community or user ID" }`                                               |                                         |
|                           |        |                            | 401         | `{ message: "Unauthorized" }`                                                               |                                         |
|                           |        |                            | 403         | `{ message: "Not authorized to modify this community" }`                                    |                                         |
|                           |        |                            | 404         | `{ message: "Community or user not found" }`                                                |                                         |
|                           |        |                            | 500         | `{ message: "Server error" }`                                                               |                                         |

## Authentication

Most endpoints require authentication. Include the JWT token in the Authorization header:

```
Authorization: Bearer <your_jwt_token>
```

## Error Handling

The API returns consistent error responses:

```json
{
  "message": "Error description",
  "error": "Detailed error information (in development)"
}
```

## Status Codes

- `200` - Success
- `201` - Created
- `400` - Bad Request
- `401` - Unauthorized
- `403` - Forbidden
- `404` - Not Found
- `500` - Internal Server Error

## Health Check

A health check endpoint is available at:

```
GET /health
```

Response: `"Server is healthy"`

## Development

For development, the server uses nodemon for automatic restarts:

```bash
npm run dev
```
|                           |        |                            | 400         | `{ message: "Invalid community or user ID" }`                                               |                                         |
|                           |        |                            | 401         | `{ message: "Unauthorized" }`                                                               |                                         |
|                           |        |                            | 403         | `{ message: "Not authorized to modify this community" }`                                    |                                         |
|                           |        |                            | 404         | `{ message: "Community or user not found" }`                                                |                                         |
|                           |        |                            | 500         | `{ message: "Server error" }`                                                               |                                         |

## Authentication

Most endpoints require authentication. Include the JWT token in the Authorization header:

```
Authorization: Bearer <your_jwt_token>
```

## Error Handling

The API returns consistent error responses:

```json
{
  "message": "Error description",
  "error": "Detailed error information (in development)"
}
```

## Status Codes

- `200` - Success
- `201` - Created
- `400` - Bad Request
- `401` - Unauthorized
- `403` - Forbidden
- `404` - Not Found
- `500` - Internal Server Error

## Health Check

A health check endpoint is available at:

```
GET /health
```

Response: `"Server is healthy"`

## Development

For development, the server uses nodemon for automatic restarts:

```bash
npm run dev
```
